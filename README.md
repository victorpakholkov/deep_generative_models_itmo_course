**Пахолков Виктор Владимирович**

**Курс "Глубокие генеративные модели (Deep Generative Models)" в AITalantedHub**


## ДЗ 5. Обучение поющей speech-to-speech модели so-VITS-svc


### 0. Data

Для выполнения этого задания я решил взять 5 композиций Франка Синатры в качестве референса для тренировки модели.
Исходником же стала песня Thieves in the Night от дуэта Black Star.
Мне захотелось заставить Синатру читать реп.

Во-первых, мне было интересно посмотреть, как модель работает с конверсией между жанрами, а не в той ситуации, когда исходник и референс принадлежат к одному жанровому диапазону.
Во-вторых, живи Синатра в наше время, он бы однозначно со своими криминальными связями и мировоззрением был бы репером. 
В-третьих, Синатра пел в разном темпе, и в некоторых треках вполне себе разгонялся почти до репа (например "I've been a puppet, a pauper, a pirate, a poet, a pawn and a king" в That's life это вполне бодрый речетатив).

Музыкальные файлы в формате mp3 были скачены с Internet Archive:

https://archive.org/details/black-star-the-album/Album/12-Thieves+In+The+Night.mp3 - исходник

https://archive.org/details/frank-sinatra-the-very-best-of - референс (5 песен, That's life, My way, Fly me to the moon, Let's fall in love, New York)

Затем, с помощью Ultimate Vocal Remover GUI и референсные композиции, и исходник были разделены на музыку и вокал.

После этого, с помощью Audio Slicer вокал, относящийся к Синатре был порезан на семплы со стандартными параметрами нарезки.

### 1. Переозвучка

Дальше, собственно, я делал все по инструкциям из ноутбука.

Подготовил данные необходимым образом, залил их на гугл диск.
Далее обучил модель на нарезанных рефернсных композициях.

Однако тренировал я модель только 200 эпох (в изначальном конфиге было намного больше), потому что коллаб постоянно выкидывал меня и ограничивал ресурсы.

Результаты трейна доступны в файле speaker0.spk.npy в этом репозитории.

Далее был проведен инференс на натренированной модели. 


### 2. Результаты

Получившийся вокал был соединен с изначальной инструментальной дорожкой с помощью Reaper.
Получившаяся композиция (в формате wav) доступна тут:

https://drive.google.com/file/d/1N0mfwu-0p8rQ0wZ6AwagJ9I9U-3jb2qZ/view?usp=sharing

Результат, честно говоря получился такой себе.
На голос Синатры получившийся вокал особо не похож, скорее на более топорный и механический голос Талиба Квели.

Причин этому может быть несколько.

Во-первых, все таки разные жанры могут давать о себе знать. 
Все таки песни Синатры и треки Black Star имеют совершенно разную жанровую принадлежность, и даже в рамках этих жанров выделяются уникальным стилем, со множеством особенностей, которые не так то просто ухватить нейросети.

Во-вторых, может влиять качество и количество данных для тренировки. 
Всего 5 треков скорее всего является недостаточным количеством данных для моей изначальной задумки.
И я не выбирал песни и отрывки из песен, где Синатра пел бы именно в высоком темпе, что, скорее всего, так же ухудшило качество результата.

В-третьих, скорее всего 200 эпох недостаточны для обучения для такой непростой задачи как перемещение голоса между жанрами.
В изначальном конфиге было намного больше, кажется тысяч десять, но столько в бесплатной версии коллаба я, конечно, не мог прогнать.
